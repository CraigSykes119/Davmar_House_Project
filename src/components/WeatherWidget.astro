---
const apiKey = import.meta.env.PUBLIC_WEATHER_API_KEY;
console.log("✅ Weather API Key:", apiKey); // Log API key to check if it's working

const lat = "51.940363"; // Blarney Latitude
const lon = "-8.568047"; // Blarney Longitude
const units = "metric";

// Fetch weather data
const fetchWeather = async () => {
  try {
    const weatherApiUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=${units}&appid=${apiKey}`;
    console.log("🌍 Fetching from URL:", weatherApiUrl);

    const response = await fetch(weatherApiUrl);
    if (!response.ok) throw new Error("❌ Failed to fetch weather data");

    return await response.json();
  } catch (error) {
    console.error("❌ Error fetching weather:", error);
    return null;
  }
};

// Get weather data
const weatherData = await fetchWeather();
---

<!-- Weather Widget -->
<div class="weather-container">
  {weatherData ? (
    <>
      <h3>🌍 {weatherData.name} Weather</h3>
      <img src={`https://openweathermap.org/img/wn/${weatherData.weather?.[0]?.icon}@2x.png`} alt="Weather Icon" />
      <p>{weatherData.weather?.[0]?.description || "No data available"}</p>
      <p>🌡️ {weatherData.main?.temp ?? "--"}°C</p>
      <p>💨 {weatherData.wind?.speed ?? "--"} m/s</p>
      <p>🌧️ Humidity: {weatherData.main?.humidity ?? "--"}%</p>
    </>
  ) : (
    <p>❌ Could not load weather data.</p>
  )}
</div>

<style>
.weather-container {
  background: #ffffff;
  padding: 15px;
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  text-align: center;
  margin: 20px auto;
  width: 350px;
}
</style>
